# 项目需求清单（覆盖100%）

本文件为需求清单，仅列出必须实现的功能与约束。

## 1. 范围与运行方式
- 纯前端可直接在浏览器打开运行（HTML/CSS/JavaScript），无打包依赖即可访问。
- 后端为独立工程（backend/），提供 RESTful API 能力，服务前端聊天及必要后端逻辑。

## 2. 个人主页
- 根页面提供个人主页，内容覆盖 assets/resume.md 的简历信息（教育、经历、项目、技能、联系方式、出版物等）。
- 首页板块：About/Projects/Skills/Publications/Footer（可按设计细化，但需具备等效信息承载能力）。
- 响应式布局；滚动锚点高亮；基础可访问性（可见焦点、语义标签、必要 ARIA）。

## 3. 多语言
- 语言集：中文（zh）、英文（en）、日文（ja）。
- 前端需支持等效的三语切换体验：
  - data-zh / data-en / data-ja 或等效资源方式；
  - 默认语言自动选择（依据浏览器），并允许手动覆盖；localStorage 记忆语言；
  - 切换后文案即时更新，切换控件有高亮/状态提示。
- 字体需保证三语良好显示。

## 4. 聊天功能（火山引擎 API）
- 提供“与我聊天”能力，调用 https://www.volcengine.com/docs/6561/1305191 的 API。
- 前端职责：
  - 聊天 UI：输入框、发送、清空、消息气泡（user/assistant）、加载与错误提示。
  - 多轮上下文（内存为默认）；是否持久化为可选项。
  - 可选流式渲染（若后端支持 SSE）。
  - 运行时可配置：后端地址、模型、温度、超时、是否流式、最大重试等。
- 后端职责（见第 6 节）：统一代理火山引擎、隐藏签名与密钥、限流与日志。

## 5. 前端实现与项目结构
- 根目录必须包含 index.html；必要时可新增子页面 HTML 文件。
- 将 index.html 中的样式与脚本拆分至：
  - css/ 目录存放样式（如 css/style.css）；
  - script/ 目录存放脚本（如 script/app.js）。
- 外链安全：所有 target="_blank" 的链接需带 rel="noopener noreferrer"。
- 字体与图标库：
  - Google Fonts：Inter、Noto Sans SC、Noto Sans JP（或等效可替代镜像），提供合理回退栈；
  - Font Awesome 6.5.x（或等效），仅加载必要图标。
- 配置通道：支持 window.RUNTIME_CONFIG 或 config.json 的运行时配置注入（不改源码即可切换后端地址与参数）。

- 配色与品牌色（新增，颜色方案设计）
  - 基调与饱和度：
    - 整体为深色、商务、冷静基调，使用饱和度“略高”的冷色系；避免过艳/暖色主导。
    - 必须定义单一核心主色 --primary，所有交互与强调围绕该主色派生。
  - 色板变量（CSS 变量，需集中于 :root）：
    - 基础：--bg、--bg-soft、--card、--divider、--text、--muted
    - 主色体系：--primary、--primary-contrast、--primary-hover、--primary-active、--accent
    - 语义色：--success、--warning、--error（饱和度适度提升但保持克制）
    - 状态与阴影：--focus-ring、--shadow、--radius
  - 示例调色参考（允许等价替换，最终以变量实现为准）：
    - --primary: 冷调蓝 500-600 区间（示例 #3B82F6 或 #528BFF）
    - --accent: 邻近冷色（示例青色 #22D3EE 或紫偏冷 #A78BFA），仅用于渐变/强调点缀
    - --bg: #0B0F14 ~ #0E1522；--card: #121A28；--text: #E8EEF9；--muted: #A9B4C5；--divider: rgba(255,255,255,.08)
  - 可访问性与对比度：
    - 正文文本与背景对比度至少 AA（≥4.5:1），大字号文本 ≥3:1
    - 主按钮/主链接的文本与底色对比度 ≥4.5:1；禁用态需有明显亮度/饱和度变化
  - 交互状态映射（必须统一围绕主色）：
    - 按钮/链接/锚点：
      - 默认：使用 --primary（或带主色渐变）+ 文本色 --primary-contrast
      - Hover：--primary-hover（亮度↑或饱和度↑，不超过 15%）
      - Active：--primary-active（亮度↓或饱和度↓，不超过 15%）
      - Focus：使用 --focus-ring 作为外发光或描边（2-3px 内外阴影任选一种），颜色源自 --primary
    - 高亮与选中：背景或描边使用主色系透明度（10%~20%），文本颜色不影响可读性
    - 禁用：降低不透明度至 40%~60%，并移除阴影/动画
  - 渐变与光效规范：
    - 渐变应以 --primary 为主锚，允许与 --accent 协同；避免跨越色相过大的对比（影响商务感）
    - 阴影 --shadow 不得影响文本可读性；卡片/按钮最多 1 层投影 + 1 层内发光
  - 组件使用约束（映射规则）：
    - Button/Chip/Anchor 高亮：背景或边框源自主色系；文本与图标对比度符合 AA
    - Section 标题装饰条/扫描线：采用主色 + 相邻冷色的低透明度渐变
    - 徽章 Badge：边框使用 --divider，填充使用主色低透明度或中性深色，文字保持高对比
  - 主题化与可配置：
    - 所有颜色必须通过 CSS 变量引用，页面内不得硬编码具体色值（示例图形装饰可例外但应引用变量）
    - 调整 --primary 后，hover/active/focus/accent 等需自动联动（通过变量或 calc）
    - 允许通过外部样式或运行时注入覆盖 :root 变量以实现一键换色（不改 HTML/JS）
  - 验收与度量：
    - 抽查至少 5 个交互元素（按钮、链接、锚点、徽章、标题装饰）颜色是否源自主色体系
    - 使用对比度工具验证文本/交互对比度达标；切换主色后无“断链色值”
## 6. 后端（backend/）
- 技术栈：Python Flask。
- 数据库：本地 MySQL；连接信息可配置（环境变量或配置文件），包含主机/端口/库名/用户/密码。
- 目录：backend/ 为根；包含依赖清单与启动脚本（开发/生产）。
- 接口（最低要求）：
  - POST /api/chat/completions：代理火山引擎聊天，处理鉴权/签名/超时/重试；返回 JSON 或 SSE。
  - GET /api/health：健康检查。
  - 可选 GET /api/config/public：提供前端可见的非敏感配置。
- 中间件与治理：
  - CORS（可配置允许来源）；限流（全局/IP）；结构化日志；统一错误结构 { code, message, requestId?, details? }。
- 持久化（可选增强）：
  - chat_sessions、chat_messages 基础表结构与初始化脚本；按 session_id 分页查询。

## 7. 配置与安全
- 配置优先级：运行时注入 > 配置文件 > 默认值。
- 严禁将密钥提交到仓库；通过环境变量或安全配置管理注入。
- 错误最小暴露、日志脱敏。

## 8. 兼容性与性能
- 浏览器兼容：现代浏览器当前及上一个大版本。
- 性能基线：首屏资源体积控制（不含字体）与懒加载策略评估；仅加载必要图标与字体子集。

## 9. SEO 与元信息
- 基础：title、charset、viewport、html lang。
- 可选：Open Graph 基础字段（og:title/description）。

## 10. 部署与文档
- 前端部署说明与外部依赖清单（CDN/镜像可替换策略）。
- 后端部署说明：开发与生产启动方式、.env.example/config.example、MySQL 初始化指引。

## 11. 测试与质量（新增）
- 目录：根级 test/，包含前端与后端基础单元测试。
- 前端测试（纯前端栈，不依赖打包）：
  - 使用浏览器运行的测试方案（Mocha + Chai CDN）；
  - 提供 test/frontend/index.html 测试运行器，加载被测脚本与断言库；
  - 至少覆盖：语言切换逻辑（localStorage 读写、data-zh/en/ja 文案应用）、锚点高亮函数的基本分支。
- 后端测试（Flask）：
  - 使用 pytest；
  - 覆盖 /api/health、/api/chat/completions 的基本成功/失败路径（对火山引擎调用使用 mock 或沙箱配置）；
  - 数据库访问可使用测试数据库或 mock；提供最小连接配置示例。
- 执行方式：
  - 前端：通过打开 test/frontend/index.html 在浏览器内运行并给出断言结果；
  - 后端：pytest 一次性可执行，含基础断言与失败信息。
- 验收门槛：
  - 关键分支有断言；能一键或简易步骤运行；
  - 测试与源码目录隔离，且不破坏生产加载路径。

## 12. 验收标准
- 前端：三语切换可用且一致；页面信息完整；结构拆分到 css/ 与 script/；配置通道可用；样式与交互正常。
- 后端：接口按约定可用；配置可注入；基础日志/限流/CORS 有效；本地可连 MySQL（如启用）。
- 聊天：通过后端成功调用火山引擎（或可替代沙箱/Mock），前端正常展示与错误处理。
- 测试：test/ 目录存在且可运行；前端与后端均有最小可用用例并通过。